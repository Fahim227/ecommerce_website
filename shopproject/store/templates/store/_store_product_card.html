{% load static %}


<div class="col-12 col-sm-6 col-md-4 col-lg-3 mb-4">
  <div class="card h-100 border-0 shadow-sm position-relative" style="border-radius: 12px; overflow: hidden;">
    <!-- Discount Badge -->
    {% if product.discount_percentage %}
    <div class="position-absolute top-0 end-0 m-2" style="z-index: 10;">
      <span class="badge bg-danger px-2 py-1" style="font-size: 0.875rem; font-weight: 600; border-radius: 6px;">
        -{{ product.discount_percentage }}%
      </span>
    </div>
    {% endif %}

    <!-- Product Image -->
    <div class="position-relative" style="background-color: #f8f9fa;">
      {% if product.image %}
      <img src="{{ product.image.url }}" class="card-img-top p-3" alt="{{ product.title }}"
        style="object-fit: contain; height: 200px;">
      {% else %}
      <svg class="bd-placeholder-img card-img-top" width="100%" height="200" xmlns="http://www.w3.org/2000/svg"
        role="img" aria-label="Placeholder">
        <rect width="100%" height="100%" fill="#e9ecef"></rect>
      </svg>
      {% endif %}
    </div>

    <!-- Icon Actions -->
    <!-- <div class="d-flex justify-content-center gap-4 py-3 border-top border-bottom bg-white">
      <button class="btn btn-link text-dark p-0 border-0" style="font-size: 1.25rem;" title="Quick View">
        <i class="bi bi-eye"></i>
      </button>
      <button class="btn btn-link text-dark p-0 border-0" style="font-size: 1.25rem;" title="Add to Wishlist">
        <i class="bi bi-heart"></i>
      </button>
      <button class="btn btn-link text-dark p-0 border-0" style="font-size: 1.25rem;" title="Compare">
        <i class="bi bi-bar-chart"></i>
      </button>
    </div> -->

    <!-- Card Body -->
    <div class="card-body d-flex flex-column">
      <!-- Product Title -->
      <a href="{% url 'store:product_detail' product.id %}" class="text-decoration-none">
        <h6 class="card-title text-primary mb-3" style="font-size: 0.95rem; line-height: 1.4;  ">
          {{ product.title }}
        </h6>
      </a>

      <!-- Rating -->
      <div class="d-flex align-items-center mb-3">
        {% if product.rating and product.review_count %}
        <div class="text-danger me-2" style="font-size: 0.9rem;">
          {% widthratio product.rating 1 1 as rating_int %}
          {% for i in "12345" %}
          {% if forloop.counter <= rating_int %} ★ {% else %} ☆ {% endif %} {% endfor %} </div>
            <small class="text-primary" style="font-size: 0.85rem;">{{ product.review_count }} reviews</small>
            {% else %}
            <div class="text-secondary" style="font-size: 0.9rem;">
              ☆☆☆☆☆
            </div>
            <small class="text-muted" style="font-size: 0.85rem;">0 reviews</small>
            {% endif %}
        </div>

        <!-- Price -->
        <div class="mt-auto">
          <div class="d-flex align-items-center gap-2">
            {% if product.discount_percentage %}
            {% widthratio product.price 100 product.discount_percentage as discount_amount %}
            {% widthratio product.price 1 1 as current_price %}
            <span class="h5 text-danger mb-0" style="font-weight: 700;">৳{{ product.price }}</span>
            <span class="text-muted text-decoration-line-through" style="font-size: 0.9rem;">
              ৳{% widthratio product.price 100 100|add:product.discount_percentage %}
            </span>
            {% else %}
            <span class="h5 text-danger mb-0" style="font-weight: 700;">৳{{ product.price }}</span>
            {% endif %}
          </div>
        </div>

        <div class="mt-4 d-flex align-items-center gap-3 ">


          <a href="{% url 'store:order_create' product.id %}" class="buy-btn btn w-100 "
            style="background-color: #f28124;color: white; ">
            Buy Now
          </a>
        </div>
        <!-- Add to cart button (inline in card) -->
        <button class="btn btn-sm add-to-cart mt-2" data-id="{{ product.uid|default:product.id }}"
          data-title="{{ product.title|escapejs }}" data-price="{{ product.price }}"
          data-image="{% if product.image %}{{ product.image.url }}{% else %}{% static 'store/img/placeholder.png' %}{% endif %}"
          data-qty="1">
          <i class="bi bi-cart-plus"></i> Add to Cart
        </button>

      </div>
    </div>
  </div>